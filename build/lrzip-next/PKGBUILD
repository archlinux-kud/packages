# Maintainer: Albert I <kras@raphielgang.org>

# Based on original lrzip PKGBUILD by:
# Contributor: Alexander F RÃ¸dseth <xyproto@archlinux.org>
# Contributor: graysky <graysky@archlinux.us>
# Contributor: <kastor@fobos.org.ar>

pkgname=lrzip-next
pkgver=0.12.4
pkgrel=1
pkgdesc='Next generation of multi-threaded compression based on rzip'
url='https://github.com/pete4abw/lrzip-next'
license=('GPL2')
arch=('x86_64')
depends=('bzip2' 'bzip3' 'lzo' 'zstd')
provides=('lrzip')
conflicts=('lrzip')
options=('lto')
source=("${pkgname}-${pkgver}.tar.gz::${url}/archive/refs/tags/v${pkgver}.tar.gz")
sha384sums=('b9b77df0fac6bdce232835cfef133ffdec74fdc6b1dec1df579907b383ef0255fc61b3c6601137322a4a69053106bc02')
b2sums=('8f015cf9e549ea313d055d4dbbaa8c063d2e134a70087ce87c17804aa632432f2c8f8ac7e138ccf2a9bb8108f9f36428c75296be3ee1a48da0e55fde8dd4c167')

build() {
  cd "${pkgname}-${pkgver}"

  CFLAGS="$CFLAGS -fomit-frame-pointer"
  CXXFLAGS="$CXXFLAGS -fomit-frame-pointer"

  ./autogen.sh --prefix=/usr "${flags}"
  make
}

package() {
  DESTDIR="${pkgdir}" make -C "${pkgname}-${pkgver}" install-strip
  ln -s lrzip-next "${pkgdir}/usr/bin/lrzip"
}

# vim: ts=2 sw=2 et:
# getver: -u 3 github.com/pete4abw/lrzip-next/blob/master/ChangeLog
