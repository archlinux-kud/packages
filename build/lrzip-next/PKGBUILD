# Maintainer: Albert I <kras@raphielgang.org>

# Based on original lrzip PKGBUILD by:
# Contributor: Alexander F RÃ¸dseth <xyproto@archlinux.org>
# Contributor: graysky <graysky@archlinux.us>
# Contributor: <kastor@fobos.org.ar>

pkgname=lrzip-next
pkgver=0.12.2
pkgrel=2
pkgdesc='Next generation of multi-threaded compression based on rzip'
url='https://github.com/pete4abw/lrzip-next'
license=('GPL2')
arch=('x86_64')
depends=('bzip2' 'bzip3' 'lzo' 'zstd')
provides=('lrzip')
conflicts=('lrzip')
options=('lto')
source=("${pkgname}-${pkgver}.tar.gz::${url}/archive/refs/tags/v${pkgver}.tar.gz")
sha384sums=('34758cb2339ad6b5d473a3c2fa488a550f33353469df4a8343392b2fe4f96e90eb6b5c6de74ffb26cee60ef8fd8d7cdf')
b2sums=('33be447174481dc5e5d0bb00c02e10b3f060fc921ba131fcc370f46c9c81a12d69f49ffdfbb4222ce6a200034ea093ccf82bc3d1e4639dd03188eeefff6c7e38')

build() {
  cd "${pkgname}-${pkgver}"

  CFLAGS="$CFLAGS -fomit-frame-pointer"
  CXXFLAGS="$CXXFLAGS -fomit-frame-pointer"

  ./autogen.sh --prefix=/usr "${flags}"
  make
}

package() {
  DESTDIR="${pkgdir}" make -C "${pkgname}-${pkgver}" install-strip
  ln -s lrzip-next "${pkgdir}/usr/bin/lrzip"
}

# vim: ts=2 sw=2 et:
# getver: -u 3 github.com/pete4abw/lrzip-next/blob/master/ChangeLog
